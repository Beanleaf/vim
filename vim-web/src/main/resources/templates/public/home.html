<!DOCTYPE html>
<html th:lang="${htmlLang}" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="fragments/header :: htmlHead"></head>
<body>
<section th:replace="fragments/header :: baseElements"></section>
<header th:replace="fragments/header :: topBar"></header>

<div class="container-lg p-3 p-responsive width-full">

  <div class="blankslate" th:if="${activeUser}">
    <h3 class="mb-1" th:text="#{home.greeting(${activeUser.getName()})}">
      home.greeting
    </h3>
    <p th:text="#{home.actions}">home.actions</p>
    <div class="BtnGroup my-3">
      <a class="btn BtnGroup-item btn-large" th:href="@{/inventory/scan/in}"
         th:text="#{inventory.actions.in.title}">Scan in</a>
      <a class="btn BtnGroup-item btn-large" th:href="@{/inventory/scan/out}"
         th:text="#{inventory.actions.out.title}">Scan out</a>
    </div>

    <div sec:authorize="hasAuthority('ADMIN')">
      <p>
        <a class="btn-link" th:href="@{/admin/inventory}"
           th:text="#{navigation.inventoryManagement}">navigation.inventoryManagement</a>
      </p>

      <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3"></script>
      <h3 th:text="#{inventory.history}"></h3>
      <span class="text-gray" th:text="#{passedDays('30')}"></span>
      <canvas class="mt-2 chart" id="logChart"></canvas>
      <script th:inline="javascript"
              th:with="ChartUtils=${T(be.beanleaf.vim.app.utils.ChartUtils)}">
        //<![CDATA[
        let chart = [];
        chart["title"] = /*[[${chart.getTitle()}]]*/ "";
        chart["type"] = /*[[${chart.getType()}]]*/ "line";
        chart["labels"] = /*[[${ChartUtils.getLabels(chart)}]]*/ [];
        chart["data"] = /*[[${ChartUtils.getData(chart)}]]*/ [];
        chart["backgroundColors"] = /*[[${ChartUtils.getBackgroundColors(chart)}]]*/ [];
        chart["borderColors"] = /*[[${ChartUtils.getBorderColors(chart)}]]*/ [];
        chart["beginYAtZero"] = /*[[${chart.isBeginYAtZero()}]]*/ false;
        chart["borderWidth"] = /*[[${chart.getBorderWidth()}]]*/ 1;
        chart["displayLegend"] = /*[[${chart.isLegendDisplay()}]]*/ true;
        //]]

        new Chart(document.getElementById("logChart"), {
          type: chart["type"],
          data: {
            labels: chart["labels"],
            datasets: [{
              label: chart["title"],
              data: chart["data"],
              backgroundColor: chart["backgroundColors"] == null ? "#b392f0"
                  : chart["backgroundColors"],
              borderColor: chart["borderColors"] == null ? "#6f42c1" : chart["borderColors"],
              borderWidth: chart["borderWidth"]
            }]
          },
          options: {
            legend: {
              display: chart["displayLegend"]
            },
            scales: {
              xAxes: [{gridLines: {display: false}}],
              yAxes: [{
                gridLines: {drawBorder: false},
                ticks: {
                  padding: 20,
                  beginAtZero: chart["beginYAtZero"]
                }
              }]
            }
          }
        });
      </script>
    </div>

  </div>
  <div class="blankslate mt-3" th:unless="${activeUser}">
    <i class="octicon mega-octicon octicon-key blankslate-icon"></i>
    <i class="octicon mega-octicon octicon-sign-in blankslate-icon"></i>
    <i class="octicon mega-octicon octicon-person blankslate-icon"></i>
    <h3 th:text="#{home.login}">home.login</h3>
    <p th:text="#{home.loginSub}">home.loginSub</p>
    <a autofocus class="btn btn-primary my-3" th:href="@{/login}" th:text="#{navigation.login}">navigation.login</a>
  </div>
</div>
</body>
<footer th:replace="fragments/footer :: footer"></footer>
</html>